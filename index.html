<!DOCTYPE HTML>
<html dir="ltr">
<head>
    <title>Изборен калкулатор на Биволъ Bivol Poll Mandate Calculator</title>
    <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta itemprop="name" content="зборен калкулатор на Биволъ Bivol Poll Mandate Calculator"/>
	<meta itemprop="description" content="Бази данни и търсачки в помощ на разследващите журналисти, гражданските активисти и обществената прозрачност. Ако цените нашата работа подкрепете сайта с абонамент, дарение или покупка на рекламен продукт."/>

	<meta http-equiv="author" content="Bivol.bg" />
	<meta http-equiv="contact" content="contact@bivol.bg" />
	<meta name="keywords" content="България, Избори" />
    <meta property="og:title" content="Изборен калкулатор на Биволъ Bivol Poll Mandate Calculator" />
	<meta property="og:description" content="Бази данни и търсачки в помощ на разследващите журналисти, гражданските активисти и обществената прозрачност. Ако цените нашата работа подкрепете сайта с абонамент, дарение или покупка на рекламен продукт." />
	<meta property="og:url" content="http://elections.bivol.bg" />
	<meta property="og:image" content="img/bivol-logo-300x300.png" /> 
<link rel="apple-touch-icon" href="img/bivol-logo-300x300.png" sizes="300x300" />
<link rel="icon" href="https://bivol.bg/wp-content/uploads/2016/01/cropped-bivol-logo-512x512-32x32.png" sizes="32x32"/> 
  <!-- Include the CSS -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/bivol.it.css" rel="stylesheet">
	
   
      <style media="screen" type="text/css">
        select,
        textarea,
        input[type="text"],
        input[type="password"],
        input[type="datetime"],
        input[type="datetime-local"],
        input[type="date"],
        input[type="month"],
        input[type="time"],
        input[type="week"],
        input[type="number"],
        input[type="email"],
        input[type="url"],
        input[type="search"],
        input[type="tel"],
        input[type="color"],
        .uneditable-input {
            display: inline-block;
            height: 20px;
            padding: 1px 1px;
            margin-bottom: 2px;
            font-size: 10pt;
            line-height: 10px;
            color: #555555;
            vertical-align: middle;
            -webkit-border-radius: 2px;
            -moz-border-radius: 2px;
            border-radius: 2px;
        }
        
        .table td {
            padding: 2px;
            line-height: 10px;
            text-align: left;
            vertical-align: top;
            border-top: 1px solid #dddddd;
        }
        
        .bolded {
            font-weight: bold;
        }
        
        .colorIndex3 {
            color: red
        }
        
        .colorIndex5 {
            color: blue
        }
        
        .firstRow {
            background: #D0D0D0;
            font-weight: bold;
            border: 1px solid black;
        }
        
        .firstCol {
            background: #D0D0D0;
            border: 1px solid black;
        }
        
        #finalTable .secondRow {
            background: #F0F0F0;
            font-weight: bold;
            border: 1px solid black;
        }
        
        #finalTable .lastCol {
            border: 1px solid black;
        }
        
        #table3p td {
            text-align: center;
            vertical-align: middle;
        }
        
        #table3i td {
            text-align: center;
            vertical-align: middle;
        }
        
        #table3 td {
            text-align: center;
            vertical-align: middle;
        }
        
        #fracTable td {
            text-align: center;
            vertical-align: middle;
        }
        
        #finalTable td {
            text-align: center;
            vertical-align: middle;
        }
        
        #fracTable .lastCol {
            border: 1px solid black;
        }
        
        #fracTable .secondRow {
            border: 1px solid black;
            font-weight: bold;
            background: #F0F0F0;
        }
        
        #fracTable .underLastCol {
            border: 1px solid black;
        }
        
        #table3p .lastCol {
            border: 1px solid black;
        }
        
        #table3p .underLastCol {
            border: 1px solid black;
        }
        
        #table3i .lastCol {
            border: 1px solid black;
        }
        
        #table3i .underLastCol {
            border: 1px solid black;
        }
        
        #table3 .secondRow {
            border: 1px solid black;
            font-weight: bold;
            background: #F0F0F0;
        }
        
        #table3 .lastCol {
            border: 1px solid black;
        }
        
        #table3 .underLastCol {
            border: 1px solid black;
        }
    </style>
    <script>
        // Fix some compatibility issues
        if (typeof console === "undefined") console = {};
        if (typeof console.log === "undefined") console.log = function(n) {};
        if (typeof Array.prototype.push === "undefined") {
            Array.prototype.push = function(n) {
                var i;
                if (n instanceof Array) {
                    for (i = 0; i < n.length; i++) this[this.length] = n[i];
                    return this;
                }
                this[this.length] = n;
                return this;
            };
        }
        if (typeof Array.prototype.forEach === "undefined") {
            Array.prototype.forEach = function(n) {
                var i;
                for (i = 0; i < this.length; i++) n(this[i]);
            };
        }
        if (typeof Array.prototype.map === "undefined") {
            Array.prototype.map = function(n) {
                var i;
                var a = [];
                for (i = 0; i < this.length; i++) a[a.length] = n(this[i]);
                return a;
            };
        }
        if (typeof Object.prototype.keys === "undefined") {
            Object.prototype.keys = function(n) {
                var i;
                var a = [];
                for (i in n) {
                    a[a.length] = i;
                }
                return a;
            };
        }
        if (typeof document.getElementsByClassName === "undefined") {
            document.getElementsByClassName = function(n) {
                var a = [];
                var cl = n.split(/ +/);
                var e = document.getElementsByTagName('*');
                var i;
                var j;
                for (i = 0; i < e.length; i++) {
                    for (j = 0; j < cl.length; j++) {
                        if (RegExp(' ' + cl[j] + ' ').test(' ' + e[i].className + ' ')) {
                            a[a.length] = e[i];
                            break;
                        }
                    }
                }
                return a;
            };
        }

        // ----

        function BgElections2013codeV4() {
            // Translation from Visual Basic to JavaScript
            var InputData;
            var x;
            var y;
            var MIR;
            var Parties;
            var Total;
            var lowPerc = parseFloat(document.getElementById("lowPerc").value);

            MIR = parseInt(document.getElementById("dim_mir").value);
            Parties = parseInt(document.getElementById("dim_party").value);

            var p = readSpecs();
            console.log(p);
            filterLowPerc(p, lowPerc);
            Parties = p.party.length; // Remove all the parties with less than 4%
            console.log(p); // Lets dump what we have here

            // Now we have in P only the values of the parties to compute
            var i;
            var j;
            var mandates = [];
            var totMandates = []; // we shall see when we use the totMandates at all, as it looks like the globalMandates is more important
            // Distrubute the mandates
            for (i = 0; i < Parties; i++) {
                mandates[i] = [];
                for (j = 0; j < MIR; j++) {
                    mandates[i][j] = p.mir[j].mandates * p.party[i].partyVotes[j] / p.mir[j].reTotalSum; // Error, not global totalsum
                }
                totMandates[i] = sumArray(mandates[i]);
            }

            // Distribution of the seats between the parties on a national level, 1st step
            var globalMandates = [];
            for (i = 0; i < Parties; i++) globalMandates[i] = p.totalMandates * p.party[i].partySum / p.reTotalSum;

            // integer parts and fractions are separated in two new tables
            var intMandates = [];
            var intTotMandates = [];
            var fracMandates = [];
            var fracTotMandates = [];
            for (i = 0; i < Parties; i++) {
                intMandates[i] = [];
                fracMandates[i] = [];
                for (j = 0; j < MIR; j++) {
                    intMandates[i][j] = parseInt(mandates[i][j]);
                    fracMandates[i][j] = mandates[i][j] - intMandates[i][j];
                }
                intTotMandates[i] = parseInt(globalMandates[i]); // globalMandates instead of totMandates
                fracTotMandates[i] = globalMandates[i] - intTotMandates[i]; // globalMandates instead of totMandates
            }

            // Lets compute the non distributed seats
            // Here we compute the non-distributed seats by constituency (MIR)
            var undistSeats = [];
            for (j = 0; j < MIR; j++) {
                undistSeats[j] = p.mir[j].mandates - sumCol(intMandates, j);
            }
            var totUndMandates = p.totalMandates - sumArray(intTotMandates); //totalMandates is missing

            // Make some cells bold (used in the calculation later, those are the first X (undistributed) mandates in the column)
            var bolded = [];
            for (i = 0; i < Parties; i++) {
                bolded[i] = [];
                for (j = 0; j < MIR; j++) {
                    bolded[i][j] = 0;
                    var r = rankCol(fracMandates[i][j], fracMandates, j);
                    if (r <= undistSeats[j]) bolded[i][j] = 1;
                }
            }

            var totBolded = [];
            for (i = 0; i < Parties; i++) {
                totBolded[i] = 0;
                if (rank(fracTotMandates[i], fracTotMandates) <= totUndMandates) totBolded[i] = 1;
            }

            var winMandates = [];
            // Calculate number of seats per party STEP 1
            for (i = 0; i < Parties; i++) {
                winMandates[i] = parseInt(globalMandates[i]) + totBolded[i];
            } //globalMandates instead of totMandates

            // Lets calculate the difference between the direct mandates and the mandate redistribution
            // It is possible to have situation where we have removal of a mandate instead of adding one, which is wrong
            var parMandates = [];
            for (i = 0; i < Parties; i++) {
                parMandates[i] = winMandates[i] - sumArray(intMandates[i]);
                if (parMandates[i] < 0) {
                    alert("Sorry, we have a problem in STEP2\nwe can not distribute a negative number of seats\nPlease send a message to CIK\ncik@cik.bg");
                }
            }

            //
            var diffMandates = []; // Here we compute the excedence
            for (i = 0; i < Parties; i++) {
                diffMandates[i] = sumArray(bolded[i]) - parMandates[i];
            }

            // the table with the whole and the distributed mandates together
            var tab4Mandates = [];
            for (i = 0; i < Parties; i++) {
                tab4Mandates[i] = [];
                for (j = 0; j < MIR; j++) {
                    tab4Mandates[i][j] = bolded[i][j] + intMandates[i][j];
                }
            }

            var tab4giveMandates = [];
            var tab4wonMandates = [];
            for (i = 0; i < Parties; i++) {
                tab4giveMandates[i] = sumArray(tab4Mandates[i]);
                tab4wonMandates[i] = winMandates[i];
            }

            // Table 3
            var tab3sumMandates = [];
            for (i = 0; i < Parties; i++) {
                tab3sumMandates[i] = sumArray(intMandates[i]);
            }

            var tab3leftMandates = [];
            for (i = 0; i < Parties; i++) {
                tab3leftMandates[i] = winMandates[i] - tab3sumMandates[i];
            }

            // ------ Mandate redistribution
            // From now on we work only on table 5 (fracMandates)

            // In the original code there is a duplication, so I am skipping it, diffMandates[i] contains the excedence already

            // The main calculation for the mandate redistribution
            var Timer;
            var finalTable = [];

            var boldCellPlus = [];
            //                var boldCellMinus = [];
            var Iplus;
            var Jplus;
            var Iminus;
            //                var Jminus;
            //                var K;
            var PlusCounter;
            var cellMinus = [];
            //                var c = [];
            var Min;

            var colorIndex = []; // We are moving the colorIndex outside
            // --- Checked up to here
            for (Timer = 0; Timer < 200; Timer++) {
                PlusCounter = 0;
                boldCellPlus = [];
                for (i = 0; i < Parties; i++) {
                    if (diffMandates[i] > 0) PlusCounter++;
                }

                if (PlusCounter === 0) {
                    alert("След " + Timer + " повторения имаме резултат!");

                    for (i = 0; i < Parties; i++) {
                        finalTable[i] = [];
                        for (j = 0; j < MIR; j++) {
                            finalTable[i][j] = bolded[i][j] + intMandates[i][j];
                        }
                    }
                    // Decoration is not copied
                    // .....
                    break;
                }

                // Article 24
                var bBold = 0;
                for (i = 0; i < Parties; i++) {
                    if (typeof colorIndex[i] === 'undefined') colorIndex[i] = [];
                    boldCellPlus[i] = [];
                    for (j = 0; j < MIR; j++) {
                        boldCellPlus[i][j] = 0;
                        if (bolded[i][j] && diffMandates[i] > 0 && colorIndex[i][j] !== 3) {
                            boldCellPlus[i][j] = 1; // Union
                            bBold = 1;
                        }
                    }
                }
                if (!bBold) {
                    alert("Внимание, настъпи проблем след " + Timer + " повторения в стъпка 3! Не може да се намери решение: Моля информирайте ЦИК на cik@cik.bg");
                    break;
                }
                var res = crossTableMinMax(fracMandates, boldCellPlus, 0);
                Min = res.val;
                Iplus = res.row;
                Jplus = res.col;

                cellMinus = [];
                var bCell = 0;
                for (k = 0; k < Parties; k++) {
                    cellMinus[k] = [];
                    if (bolded[k][Jplus] === 0 && colorIndex[k][Jplus] !== 3) {
                        cellMinus[k][Jplus] = 1;
                        bCell = 1;
                    }
                }
                if (bCell) {
                    res = crossTableMinMax(fracMandates, cellMinus, 1);
                    Iminus = res.row;
                    // var counter = Jplus; //???
                    bolded[Iplus][Jplus] = 0;
                    bolded[Iminus][Jplus] = 1; // fixed typo
                    colorIndex[Iplus][Jplus] = 3;
                    colorIndex[Iminus][Jplus] = 5;
                    for (i = 0; i < Parties; i++) {
                        diffMandates[i] = sumArray(bolded[i]) - parMandates[i];
                    }
                } else {
                    for (i = 0; i < Parties; i++) colorIndex[i][Jplus] = 3; // red color according to art. 26
                }
            }

            console.log(finalTable);

            // Visualization need to happen here

            var visual = document.getElementById("outResults");

            var t = "";


            // ----------- Visualize Table of fractions
            var t3 = [];
            t3[0] = [""].concat(p.mir.map(function(n) {
                return n.name;
            })).concat(["Сборно", "Спечелени"]);
            t3[1] = ["Мандати за:"].concat(p.mir.map(function(n) {
                return n.mandates;
            })).concat([p.totalMandates, p.totalMandates]);
            for (i = 0; i < mandates.length; i++) {
                t3.push([p.party[i].partyName]);
                for (j = 0; j < mandates[i].length; j++) t3[2 + i][1 + j] = mandates[i][j].toFixed(3);
            }
            for (i = 0; i < Parties; i++) {
                t3[2 + i][1 + MIR] = globalMandates[i].toFixed(3);
                t3[2 + i][2 + MIR] = winMandates[i];
            }
            t += "<div class='Step2'><H2>Втора стъпка, спечелени мандати</H2></div>" + buildTable(t3, 'table3');

            var t3i = [];
            t3i[0] = [""].concat(p.mir.map(function(n) {
                return n.name;
            })).concat(["Раздадени", "Остават за раздаване"]);
            for (i = 0; i < intMandates.length; i++) {
                t3i.push([p.party[i].partyName].concat(intMandates[i]).concat([sumArray(intMandates[i]), winMandates[i] - sumArray(intMandates[i])]));
            }
            t += "<div class='Step2i'><H2>Първоначални (цели) мандати</H2></div>" + buildTable(t3i, 'table3i');

            var t3p = [];
            t3p[0] = [""].concat(p.mir.map(function(n) {
                return n.name;
            })).concat(["Раздадени", "Спечелени"]);
            for (i = 0; i < intMandates.length; i++) {
                t3p.push([p.party[i].partyName].concat(tab4Mandates[i]).concat([tab4giveMandates[i], tab4wonMandates[i]]));
            }
            t += "<div class='Step2p'><H2>Раздадени първоначални (цели) и допълнителни (дробни) мандати</H2></div>" + buildTable(t3p, 'table3p');

            // ------------ Visualize the Frac table, we need to add the colours here
            var t4 = [
                [""].concat(p.mir.map(function(n) {
                    return n.name;
                })).concat(["", ""]), [""]
            ];
            t4[1][1 + MIR] = "Остават";
            t4[1][2 + MIR] = "";
            for (i = 0; i < Parties; i++) {
                t4[i + 2] = [p.party[i].partyName];
                for (j = 0; j < MIR; j++) {
                    t4[i + 2][j + 1] = {
                        value: fracMandates[i][j].toFixed(3),
                        attr: []
                    };
                    if (bolded[i][j]) t4[i + 2][j + 1].attr.push("bolded");
                    try {
                        if (colorIndex[i][j]) t4[i + 2][j + 1].attr.push("colorIndex" + colorIndex[i][j]);
                    } catch (e) {};
                }
                t4[i + 2][MIR + 1] = sumArray(bolded[i]);
                t4[i + 2][MIR + 2] = diffMandates[i];
            }
            for (j = 0; j < MIR; j++) t4[1][1 + j] = sumCol(bolded, j);
            t += "<div class='step3'><H2>Трета стъпка</H2></div>" + buildTable(t4, 'fracTable') + "<BR>Цветова легенда: 1) С <B>получер шрифт</B> се отбелязват клетки, които са получили допълнителен мандат при раздаването на дробните части. В процеса на сметките, една клетка може да бъде почернена или обратно, да стане нормална (но тогава става и червена, виж 2).<BR>2) <font color=\"red\">Червените клетки</font> са клетки които повече не участват в раздаването на мандати според методиката на ЦИК. Например, ако от една клетка е взет мандат за да се сложи в друга, тя повече не участва и става червена. Или пък ако цял един МИР повече не участва в разпределението, той става изцяло червен. Т.е. Червен = забрана за операции. <BR>3) <font color=\"blue\"><B>Сините клетки</B></font> са за информация. Това са клетки които са получили допълнителен мандат, въпреки че не им се е полагало в началото. Следователното сините са едновременно и почернени.";

            // ------------ Visualize Table 5
            var t5 = [];
            t5[0] = [""].concat(p.mir.map(function(n) {
                return n.name;
            })).concat("Сборно");
            t5[1] = ["Мандати за:"];
            var sum = 0;
            for (i = 0; i < finalTable[0].length; i++) {
                t5[1][1 + i] = sumCol(finalTable, i);
                sum += t5[1][1 + i];
            }
            t5[1][i + 1] = sum;
            for (i = 0; i < finalTable.length; i++) {
                t5.push([p.party[i].partyName].concat(finalTable[i]).concat(sumArray(finalTable[i])));
            }
            t += "<div class='finalTable'><H2>Окончателно разпределение на мандатите по партии и MИР</H2></div>" + buildTable(t5, 'finalTable');
            // ----------- End of Table 5

            visual.innerHTML = t;
        }

        function crossTableMinMax(t1, t2, max) {
            var i;
            var j;
            var val = 'x';
            var row;
            var col;

            for (i = 0; i < t2.length; i++) {
                for (j = 0; j < t2[i].length; j++) {
                    if (!t2[i][j]) continue;
                    if (val === 'x' || (max ? (val < t1[i][j]) : (val > t1[i][j]))) {
                        val = t1[i][j];
                        row = i;
                        col = j;
                    }
                }
            }

            return {
                val: val,
                row: row,
                col: col
            };
        }

        function rank(num, arr, order) { // Rank in row
            var i;
            var a = arr.slice(0); //copy array
            a.sort().reverse(); // Sort the array
            if (order) a.sort(); // Sort the array progresively
            i = a.indexOf(num);
            if (i >= 0) return i + 1;
            return arr.length + 1;
        }

        function rankCol(num, arr, col, order) { // Rank in col
            var i;
            var a = [];
            for (i = 0; i < arr.length; i++) a.push(arr[i][col]);
            return rank(num, a, order);
        }

        function sumArray(t) {
            var sum = 0;
            t.forEach(function(n) {
                sum += n;
            });
            return sum;
        }

        function sumRow(t, row) {
            return sumArray(t[row]);
        }

        function sumCol(t, col) {
            var sum = 0;
            var i;
            for (i = t.length - 1; i >= 0; i--) sum += t[i][col];
            return sum;
        }

        function buildTable(a, id) {
            var i, j;
            var t = "";
            for (i = 0; i < a.length; i++) {
                var c = [];
                if (i === 0) c.push("firstRow");
                if (i === 1) c.push("secondRow");
                if (i === a.length - 1) c.push("lastRow");
                if (i === a.length - 2) c.push("underLastRow");
                c.push("row" + (i + 1));
                t += "<tr class=\"" + c.join(" ") + "\">";
                for (j = 0; j < a[i].length; j++) {
                    var c2 = [];
                    if (j === 0) c2.push("firstCol");
                    if (j === 1) c2.push("secondCol");
                    if (j === a[i].length - 1) c2.push("lastCol");
                    if (j === a[i].length - 2) c2.push("underLastCol");
                    c2.push("col" + (j + 1));
                    var tt = "";
                    if (typeof a[i][j] === 'object') {
                        if (a[i][j].attr) c2 = c2.concat(a[i][j].attr);
                        // Generate td with attributes and then add the value
                        tt = "<td class=\"" + c.concat(c2).join(" ") + "\">" + a[i][j].value + "</td>";
                    } else {
                        tt = "<td class=\"" + c.concat(c2).join(" ") + "\">" + a[i][j] + "</td>";
                    }
                    t += tt;
                };
                t += "</tr>\n";
            }
            return "<table class=\"table\" " + ((id) ? "id='" + id + "' " : "") + ">\n" + t + "</table>\n";
        }

        function filterLowPerc(p, perc) { // Will remove from array of objects p (output from readSpecs) everything under "perc" percentage and will recalculate
            var i;
            for (i = p.party.length - 1; i >= 0; i--) {
                if (p.party[i].partyPerc < perc) p.party.splice(i, 1);
            }
            // Recalculate the total sum and the perc
            p.reTotalSum = 0;
            for (i = p.party.length - 1; i >= 0; i--) p.reTotalSum += p.party[i].partySum;
            for (i = p.party.length - 1; i >= 0; i--) p.party[i].rePartyPerc = 100 * p.party[i].partySum / p.reTotalSum;
            for (i = p.mir.length - 1; i >= 0; i--) {
                p.mir[i].reTotalSum = 0;
                p.party.forEach(function(n) {
                    p.mir[i].reTotalSum += n.partyVotes[i];
                });
            }
        }

        function readSpecs() { // Read the specs from the table into an array of objects for easy manipulation
            var tr = document.getElementsByClassName("partyRow");
            var i, j;
            var p = {
                party: [],
                mir: [],
                totalSum: 0,
                reTotalSum: 0,
                totalMandates: 0
            };
            var dim_mir = document.getElementById("dim_mir").value;
            var dim_party = document.getElementById("dim_party").value;
            for (i = 0; i < tr.length; i++) {
                var row = tr.item(i);
                var pp = [];
                var po = {
                    partyName: "",
                    partySum: 0,
                    partyPerc: 0,
                    rePartyPerc: 0,
                    partyVotes: []
                };
                for (j = 0; j < dim_mir; j++) pp.push(parseInt(row.cells[1 + j].firstChild.value));
                po.partyVotes = pp;
                po.partyName = row.cells[0].firstChild.value; // get the name
                po.partySum = sumArray(pp);
                p.totalSum += po.partySum;
                p.party.push(po);
            }
            p.party.forEach(function(n) {
                n.partyPerc = 100 * n.partySum / (p.totalSum ? p.totalSum : 1);
                n.rePartyPerc = n.partyPerc;
            });
            var row = document.getElementsByClassName("manHeader").item(0);
            for (j = 0; j < dim_mir; j++) {
                p.mir[j] = {
                    mandates: parseInt(row.cells[1 + j].firstChild.value),
                    name: "",
                    totalSum: 0,
                    reTotalSum: 0
                };
                p.party.forEach(function(n) {
                    p.mir[j].totalSum += n.partyVotes[j];
                });
                p.mir[j].reTotalSum = p.mir[j].totalSum;
                p.totalMandates += p.mir[j].mandates;
            }
            var row = document.getElementsByClassName("inHeader").item(0);
            for (j = 0; j < dim_mir; j++) p.mir[j].name = row.cells[1 + j].firstChild.value;
            p.reTotalSum = p.totalSum;
            return p;
        }

        function calcBgElections2013() {
            BgElections2013codeV4();
        }

        function sumRow(name, output) {
            var o = document.getElementById(output);
            var s = document.getElementsByClassName(name);
            var i, sum = 0;
            for (i = s.length - 1; i >= 0; i--) {
                if (s.item(i).tagName === "INPUT") sum += parseInt(s.item(i).value);
                else
                    sum += parseInt(s.item(i).innerHTML);
            }
            o.innerHTML = sum;
        };

        function calcProc() {
            var total = document.getElementById("totalSum").innerHTML;
            var dim_party = document.getElementById("dim_party").value;
            var i;
            for (i = dim_party; i; i--) {
                var s = document.getElementById("sumParty" + i).innerHTML;
                var o = document.getElementById("procParty" + i);
                o.innerHTML = (100 * parseInt(s) / parseInt(total)).toFixed(3) + "%";
            }
        }

        function genTable() {
            var visual = document.getElementById("visual");
            // Clear the data
            visual.innerHTML = "";

            var dim_mir = parseInt(document.getElementById("dim_mir").value);
            var dim_party = parseInt(document.getElementById("dim_party").value);

            if (dim_mir < 1) return alert("Некоректно количество МИР");
            if (dim_party < 1) return alert("Некоректно количество Партии");

            // Generate the table
            var t = "";
            var i;
            var j;

            // Table header
            t += "<tr class='inHeader'><td>&nbsp;</td>";
            for (i = 1; i <= dim_mir; i++) {
                t = t + "<td><input type=text size=6  class=\"manName\" value=\"МИР" + i + "\"></td>";
            }

            t += "<td>Общо:</td><td>Проценти:</td></tr>\n";

            // Мандати за района
            t += "<tr class='manHeader'><td>Мандати за района:</td>";
            for (i = dim_mir; i; i--) {
                t = t + "<td><input type=text value='0' class='mandate' size=3 onChange='sumRow(\"mandate\",\"sumMandates\")'></td>";
            }
            t += "<td id='sumMandates'>0</td><td>&nbsp;</td></tr>\n";

            // Партии
            for (j = 1; j <= dim_party; j++) {
                t += "<tr class='partyRow'><td><input type=text size=10 class='partyName' value='Партия " + j + "'></td>";
                for (i = dim_mir; i; i--) {
                    t += "<td><input type=text size=3 value='0' class='partyCol" + i + " partyRow" + j + "' onChange='sumRow(\"partyRow" + j + "\",\"sumParty" + j + "\"); sumRow(\"partyCol" + i + "\",\"sumPartyCol" + i + "\"); sumRow(\"partyRowSums\",\"totalSum\"); calcProc();'></td>";
                }
                t += "<td class='partyRowSums' id='sumParty" + j + "'>0</td><td id='procParty" + j + "'>0.000%</td></tr>\n";
            }

            // Sum footer
            t += "<tr class='sumFooter'><td>&nbsp;</td>";
            for (i = dim_mir; i; i--) {
                t += "<td id='sumPartyCol" + i + "'>0</td>";
            }
            t += "<td id='totalSum'>0</td><td>100.000%</td></tr>\n";

            // Lets set the sumout

            visual.innerHTML = "<form>Не се броят партии спечелили под: <input id='lowPerc' type=text size=3 value=4>% <br><table class=\"table\">" + t + "</table><input type=button value=\"Калкулирай\" onClick=\"calcBgElections2013();\" class=\"btn\" ></form><div id=\"outResults\"></div>";
        }

        // Predefined demo data

        var Demo2009 = {
            pVotes: {
                "РЗС": [18259, 7823, 8104, 8409, 2093, 3228, 2263, 3329, 781, 5199, 4465, 2341, 6164, 7006, 7371, 10753, 6868, 983, 7097, 1883, 3280, 1605, 7997, 7152, 8327, 6055, 8870, 2272, 5819, 2482, 4719, 1573],
                "ГЕРБ": [69710, 90033, 118111, 62371, 20273, 38422, 35727, 40285, 18648, 31432, 33824, 31403, 62423, 31366, 59081, 88944, 77500, 18885, 55732, 23595, 40912, 24658, 98933, 88745, 104333, 59454, 79364, 18759, 57706, 36093, 28493, 33368],
                "ДПС": [32811, 38239, 23835, 12211, 2830, 7104, 3950, 14653, 67770, 969, 6695, 2187, 27283, 979, 10718, 9385, 22374, 43960, 18752, 30458, 8988, 16559, 1129, 1307, 1205, 7134, 9579, 32697, 22898, 35715, 2221, 75786],
                "Атака": [12064, 48398, 34524, 16732, 3408, 9451, 7545, 14097, 2305, 4735, 8626, 6956, 13083, 5026, 20384, 11549, 21247, 4828, 16290, 6605, 10397, 2933, 10037, 10168, 10640, 15215, 21307, 6086, 15450, 9798, 9591, 6232],
                "КБ": [24601, 32569, 42275, 25119, 15906, 24978, 12836, 25650, 6304, 18633, 16862, 18651, 27629, 16618, 30421, 31785, 39927, 6932, 20313, 10974, 22552, 16782, 43915, 31412, 36418, 31475, 39356, 12345, 25069, 17786, 18172, 3849],
                "СК": [11518, 12444, 15551, 8678, 3103, 4590, 3819, 4533, 983, 4510, 5234, 4908, 7809, 4677, 11532, 16425, 11507, 1967, 6578, 1073, 3871, 2412, 43120, 33856, 22992, 6566, 10353, 1432, 5131, 2550, 2906, 9043]
            },
            mandates: [9, 11, 12, 8, 3, 6, 4, 6, 4, 4, 4, 5, 8, 4, 9, 9, 10, 4, 7, 4, 6, 4, 11, 10, 10, 7, 10, 4, 7, 5, 4, 0],
            mirNames: [
                "МИР1", "МИР2", "МИР3", "МИР4", "МИР5", "МИР6", "МИР7", "МИР8", "МИР9", "МИР10",
                "МИР11", "МИР12", "МИР13", "МИР14", "МИР15", "МИР16", "МИР17", "МИР18", "МИР19", "МИР20",
                "МИР21", "МИР22", "МИР23", "МИР24", "МИР25", "МИР26", "МИР27", "МИР28", "МИР29", "МИР30",
                "МИР31", "МИР32"
            ]
        };

        var Demo2013 = {
            pVotes: {
                "БСП": [32060, 45533, 48496, 38330, 17662, 28772, 15678, 23049, 8943, 22038, 20218, 23062, 33395, 20687, 41856, 41247, 46852, 9721, 27581, 13897, 23874, 17638, 61912, 46484, 55470, 35896, 50103, 13306, 33219, 19478, 21585, 4907],
                "Атака": [11326, 7801, 19909, 9989, 3418, 7679, 5051, 6016, 1333, 7312, 4763, 8212, 13379, 7166, 11449, 13252, 11731, 2034, 9486, 2614, 6610, 1403, 13086, 12325, 14912, 9917, 12626, 2751, 8408, 5304, 4364, 3018],
                "ГЕРБ": [47632, 66509, 73163, 32966, 12283, 22984, 21862, 25199, 12721, 19610, 19431, 19683, 34974, 20046, 34146, 62003, 48904, 10325, 32545, 16127, 25791, 15652, 78117, 63863, 69828, 37798, 48020, 10771, 34038, 21590, 19152, 23090],
                "ДПС": [19005, 22680, 14219, 7392, 474, 7971, 2983, 10465, 46407, 445, 4672, 2525, 17258, 455, 9269, 6200, 14885, 28149, 10827, 17411, 5764, 10078, 1154, 1129, 1553, 3278, 13097, 21449, 17637, 25131, 1770, 54353]
            },
            mandates: [11, 14, 15, 8, 4, 6, 4, 6, 5, 4, 5, 5, 9, 4, 9, 11, 11, 4, 8, 4, 6, 4, 16, 12, 14, 8, 11, 4, 8, 6, 4, 0],
            mirNames: [
                "МИР1", "МИР2", "МИР3", "МИР4", "МИР5", "МИР6", "МИР7", "МИР8", "МИР9", "МИР10",
                "МИР11", "МИР12", "МИР13", "МИР14", "МИР15", "МИР16", "МИР17", "МИР18", "МИР19", "МИР20",
                "МИР21", "МИР22", "МИР23", "МИР24", "МИР25", "МИР26", "МИР27", "МИР28", "МИР29", "МИР30",
                "МИР31", "МИР32"
            ]
        };

        var Demo2014 = {
            pVotes: {
                "РБ": [10033, 11245, 17377, 7863, 2637, 3705, 3249, 4498, 1668, 2941, 3983, 6071, 6592, 5019, 8305, 13763, 7563, 3014, 7733, 3163, 4172, 2152, 43192, 32308, 21691, 7333, 9357, 3378, 15565, 4024, 2689, 15523],
                "ГЕРБ": [50752, 63625, 69636, 32736, 12256, 21486, 21604, 23391, 11984, 20150, 19459, 17063, 36208, 19955, 32542, 61249, 46471, 10161, 30105, 16314, 25821, 18424, 74865, 59545, 65604, 36320, 49062, 11937, 34381, 21870, 18647, 38868],
                "АТАКА": [5609, 4111, 8834, 5960, 2373, 5039, 3570, 3756, 791, 3996, 3431, 4937, 6621, 3464, 7459, 5652, 5728, 1143, 5410, 1425, 4269, 1753, 8444, 7404, 8721, 5187, 7301, 1511, 4515, 2909, 4510, 2429],
                "ББЦ": [8075, 7936, 10016, 6150, 3485, 8729, 3283, 5621, 1138, 7539, 3716, 8683, 6475, 5630, 9824, 8242, 9814, 1469, 6025, 2295, 4481, 3900, 4483, 4147, 6665, 9513, 10598, 2507, 7499, 3395, 3933, 1672],
                "АБВ": [5456, 5475, 9876, 5862, 1272, 5514, 2192, 3399, 709, 2364, 2672, 3620, 3994, 5177, 6727, 5707, 5602, 925, 3815, 2113, 2953, 1260, 9933, 6844, 9078, 4546, 5900, 2453, 3009, 2896, 2243, 2637],
                "ДПС": [23025, 27298, 15798, 11685, 2425, 10626, 2931, 15855, 59881, 864, 8883, 4928, 17348, 1012, 10384, 5820, 14695, 33334, 12807, 21007, 7644, 12218, 1934, 2043, 2539, 5773, 14938, 26240, 20680, 28858, 3723, 59938],
                "БСП": [19170, 21617, 24711, 19612, 11089, 16818, 9464, 12224, 4926, 14367, 12056, 10670, 19499, 9030, 21596, 19786, 28316, 5324, 13455, 8015, 12476, 9748, 32199, 23415, 24264, 21306, 28563, 7554, 16087, 10701, 13834, 3635],
                "ПФ": [9424, 24627, 17551, 9632, 1720, 5521, 3969, 6834, 1753, 2668, 4460, 2532, 5475, 2870, 10955, 12992, 10538, 2563, 10086, 4182, 5589, 2335, 12290, 10317, 11711, 7275, 12394, 3224, 8685, 5576, 4203, 5150]
            },
            mandates: [11, 14, 15, 8, 4, 6, 4, 6, 5, 4, 5, 5, 9, 4, 9, 11, 11, 4, 8, 4, 6, 4, 16, 12, 14, 8, 11, 4, 8, 6, 4, 0],
            mirNames: [
                "МИР1", "МИР2", "МИР3", "МИР4", "МИР5", "МИР6", "МИР7", "МИР8", "МИР9", "МИР10",
                "МИР11", "МИР12", "МИР13", "МИР14", "МИР15", "МИР16", "МИР17", "МИР18", "МИР19", "МИР20",
                "МИР21", "МИР22", "МИР23", "МИР24", "МИР25", "МИР26", "МИР27", "МИР28", "МИР29", "МИР30",
                "МИР31", "МИР32"
            ]
        };

        var Demo2014b = {
            pVotes: {
                "РБ": [10033, 11245, 17377, 7863, 2637, 3705, 3249, 4498, 1668, 2941, 3983, 6071, 6592, 5019, 8305, 13763, 7563, 3014, 7733, 3163, 4172, 2152, 43192, 32308, 21691, 7333, 9357, 3378, 15565, 4024, 2689, 15523],
                "ГЕРБ": [50752, 63625, 69636, 32736, 12256, 21486, 21604, 23391, 11984, 20150, 19459, 17063, 36208, 19955, 32542, 61249, 46471, 10161, 30105, 16314, 25821, 18424, 74865, 59545, 65604, 36320, 49062, 11937, 34381, 21870, 18647, 38868],
                "АТАКА": [5609, 4111, 8834, 5960, 2373, 5039, 3570, 3756, 791, 3996, 3431, 4937, 6621, 3464, 7459, 5652, 5728, 1143, 5410, 1425, 4269, 1753, 8444, 7404, 8721, 5187, 7301, 1511, 4515, 2909, 4510, 2429],
                "ББЦ": [8075, 7936, 10016, 6150, 3485, 8729, 3283, 5621, 1138, 7539, 3716, 8683, 6475, 5630, 9824, 8242, 9814, 1469, 6025, 2295, 4481, 3900, 4483, 4147, 6665, 9513, 10598, 2507, 7499, 3395, 3933, 1672],
                "АБВ": [5456, 5475, 9876, 5862, 1272, 5514, 2192, 3399, 709, 2364, 2672, 3620, 3994, 5177, 6727, 5707, 5602, 925, 3815, 2113, 2953, 1260, 9933, 6844, 9078, 4546, 5900, 2453, 3009, 2896, 2243, 2637],
                "ДПС": [23025, 27298, 15798, 11685, 2425, 10626, 2931, 15855, 59881, 864, 8883, 4928, 17348, 1012, 10384, 5820, 14695, 33334, 12807, 21007, 7644, 12218, 1934, 2043, 2539, 5773, 14938, 26240, 20680, 28858, 3723, 59938],
                "БСП": [19170, 21617, 24711, 19612, 11089, 16818, 9464, 12224, 4926, 14367, 12056, 10670, 19499, 9030, 21596, 19786, 28316, 5324, 13455, 8015, 12476, 9748, 32199, 23415, 24264, 21306, 28563, 7554, 16087, 10701, 13834, 3635],
                "ПФ": [9424, 24627, 17551, 9632, 1720, 5521, 3969, 6834, 1753, 2668, 4460, 2532, 5475, 2870, 10955, 12992, 10538, 2563, 10086, 4182, 5589, 2335, 12290, 10317, 11711, 7275, 12394, 3224, 8685, 5576, 4203, 5150]
            },
            mandates: [10, 13, 14, 8, 4, 6, 4, 6, 6, 4, 5, 5, 8, 4, 8, 11, 10, 4, 7, 4, 5, 4, 15, 12, 12, 8, 11, 4, 8, 6, 4, 10],
            mirNames: [
                "МИР1", "МИР2", "МИР3", "МИР4", "МИР5", "МИР6", "МИР7", "МИР8", "МИР9", "МИР10",
                "МИР11", "МИР12", "МИР13", "МИР14", "МИР15", "МИР16", "МИР17", "МИР18", "МИР19", "МИР20",
                "МИР21", "МИР22", "МИР23", "МИР24", "МИР25", "МИР26", "МИР27", "МИР28", "МИР29", "МИР30",
                "МИР31", "МИР32"
            ]
        };

        var DemoBug = {
            pVotes: {
                "П 1": [9000, 69900],
                "П 2": [31000, 70100]
            },
            mandates: [4, 4],
            mirNames: [
                "МИР1", "МИР2"
            ]
        };
        // Predefined data functions
        function fillDemo2013() {
            var data = Demo2013;
            console.log("fillDemo", data);
            fillDemo(data);
        }

        function fillDemo2014() {
            var data = Demo2014;
            console.log("fillDemo", data);
            fillDemo(data);
        }

        function fillDemo2014b() {
            var data = Demo2014b;
            console.log("fillDemo", data);
            fillDemo(data);
        }

        function fillDemo2009() {
            var data = Demo2009;
            console.log("fillDemo", data);
            fillDemo(data);
        }

        function fillDemoBug() {
            var data = DemoBug;
            console.log("fillDemo", data);
            fillDemo(data);
        }

        function item(m, i) {
            if (m.item) return m.item(i);
            return m[i]
        }

        // Data fill function
        function fillDemo(myData) {
            var data = myData || Demo2009;
            console.log("fillDemo", data);

            var pk = Object.keys(data.pVotes).sort();
            var party = pk.length;
            var mir = data.mandates.length;

            document.getElementById("dim_mir").value = mir;
            document.getElementById("dim_party").value = party;

            genTable();

            var m = document.getElementsByClassName("mandate");
            var i;

            for (i = 0; i < mir; i++) item(m, i).value = parseInt(data.mandates[i]);
            sumRow("mandate", "sumMandates");
            for (i = 0; i < pk.length; i++) {
                m = document.getElementsByClassName("partyRow" + (i + 1));
                for (var j = 0; j < mir; j++) item(m, j).value = data.pVotes[pk[i]][j];
                sumRow("partyRow" + (i + 1), "sumParty" + (i + 1));
                m = document.getElementsByClassName("partyName");
                item(m, i).value = pk[i];
            }
            m = document.getElementsByClassName("manName");
            for (i = 0; i < mir; i++) {
                sumRow("partyCol" + (i + 1), "sumPartyCol" + (i + 1));
                if (data.mirNames[i]) item(m, i).value = data.mirNames[i];
            }
            sumRow("partyRowSums", "totalSum");
            calcProc();
        }

        function importFromCSV(txt) {
            // This function is using aggresively new JS functions and will not work on old browsers 
            var o = {};
            var mnds = {};
            txt.match(/(\S+);(.+?);(\d+)/g).forEach(function(n) {
                var r = n.match(/(\S+);(.+?);(\d+)/);
                if (r) { // a bit of duplication 
                    if (typeof o[r[2]] === 'undefined') o[r[2]] = [];
                    o[r[2]][parseInt(r[1]) - 1] = r[3];
                    mnds[parseInt(r[1]) - 1] = 1;
                }
            });
            var mlen = Object.keys(mnds).length;
            console.log("import", o);
            fillDemo({
                mandates: [11, 14, 15, 8, 4, 6, 4, 6, 5, 4, 5, 5, 9, 4, 9, 11, 11, 4, 8, 4, 6, 4, 16, 12, 14, 8, 11, 4, 8, 6, 4, 0].slice(0, mlen),
                mirNames: [
                    "МИР1", "МИР2", "МИР3", "МИР4", "МИР5", "МИР6", "МИР7", "МИР8", "МИР9", "МИР10",
                    "МИР11", "МИР12", "МИР13", "МИР14", "МИР15", "МИР16", "МИР17", "МИР18", "МИР19", "МИР20",
                    "МИР21", "МИР22", "МИР23", "МИР24", "МИР25", "МИР26", "МИР27", "МИР28", "МИР29", "МИР30",
                    "МИР31", "МИР32"
                ].slice(0, mlen),
                pVotes: o
            });
        }

        function loadFromFile() {
            var f = document.getElementById("filename");
            var r = new FileReader();
            r.onload = function(e) {
                console.log("file is loaded ", e);
                console.log("file content is ", e.target.result);
                importFromCSV(e.target.result);
            };
            r.readAsText(f.files[0], "UTF-8");
        }
    </script>
</head>

<body data-spy="scroll" data-target=".navbar" data-offset="40">

<!-- Навигация -->
			<nav class="navbar navbar-default navbar-fixed-top">
				  <div class="container-fluid">
						<div class="navbar-header">
							<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#Bivol-IT-Nav" aria-expanded="false">
							  <span class="icon-bar"></span>
							  <span class="icon-bar"></span>
							  <span class="icon-bar"></span>                        
						  </button>
						  <a class="navbar-brand" href="https://bivol.bg" target="_blank">
							<img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-small-nav">
						  </a>
						</div>
						
						  <div> <!-- Допълнителен див... -->	
						  <div class="collapse navbar-collapse" id="Bivol-IT-Nav">
							<ul class="nav navbar-nav">
							  <li><a href="#search-form">Търси <span class="bivol-it-text-separator-dot"></span> Search</a></li>
							  
							  
							  <li><a class="bivol-it-nav-link-search-tools" href="#search-tools">Търсачки <span class="bivol-it-text-separator-dot"></span> Search tools</a></li>							  
							  <li><a class="bivol-it-nav-link-support-us" href="#support-us">Подкрепете ни <span class="bivol-it-text-separator-dot"></span> Support us</a></li>		  
							</ul>							
							<ul class="nav navbar-nav navbar-right">

								<!-- Падащо меню - Език -->
								<li class="dropdown">
								  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Език <span class="bivol-it-text-separator-dot"></span> Language <span class="caret"></span></a>
								  <ul class="dropdown-menu">
									<li><a href="#">Български</a></li>	
									<li role="separator" class="divider bivol-separator-nav-li-small-screen-none"></li> <!-- Междинен - не се вижда на малки екрани... -->
									<li><a href="#" class="bivol-dropdown-menu-li-a-last">English</a></li> <!-- Последен линк - има хувър с border-bottom left/right... -->
									<li role="separator" class="divider bivol-separator-nav-li"></li> <!-- Последен сепаратор - не се вижда на големи екрани... -->										
								  </ul>
								</li>
								<!-- Падащо меню - Език -->						
							
								<li><a class="navbar-link" href="https://shop.bivol.bg" target="_blank">Биволъ Магазинъ <span class="bivol-it-text-separator-dot"></span> Bivol Shop</a></li>								        
							</ul>
						  </div> <!-- /.collapse navbar-collapse -->
						  </div> <!-- Допълнителен див... -->		
						  <div class="text-center"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator-nav grayscale-1 opacity-yes mb10"></div>
				  </div> <!-- /.container-fluid -->
			</nav>
<!-- Навигация -->

<div class="container">
<div class="row mb30">
<div class="col-sm-1 col-sm-offset-0 text-center">
<a href="https://bivol.bg"><img src="http://search.bivol.bg/img/bivol_logo_big.png" class="bivol-logo box-shadow-yes"></a>
</div>
<div class="col-sm-8 col-sm-offset-3 text-center">
<h1 class="font-normal"><span class="text-shadow-yes">Изборен калкулатор</span><BR><small>Пресмятане на мандатите по методологията на ЦИК</small><BR></h1>
</div>
</div> 
</div>
 <div class="container">
    <div class="row">
       
        <h1>Пресметни си сам резултатите от Парламентарни избори 2014</h1>
        <div>
            <p>Програма за пресмятане на крайните резултати от изборите с отворен код на Javascript, работеща в браузърите IE10+, Firefox 20+, Chrome 23+, Opera 12.10+, Safari 5.1+.</p>
            <P>Програмата обработва изборните резултати съгласно методиката на ЦИК точно като софтуера използван от фирмата "Информационно обслужване". Фирмата беше избрана от ЦИК за компютърна обработка на резултатите от Избори 2013 г. и Избори 2014 г.

                <P>Офертата на фирма "Информационно обслужване" през 2013 беше единствената и възлизаше на 1 687 896 лева с ДДС.

                    <P>След като ЦИК категорически отказа да публикува изходния код за тази компютърна обработка с несъстоятелния и комичен аргумент, че някой може да фалшифицира изборите, Биволъ се обърна към специалисти математици и програмисти сред българите
                        в чужбина, които буквално
                        <B>за няколко дни</B> написаха тази не особено сложна програма.

                        <P>Освен това програмата демонстрира бъговете заложени в методиката приета от ЦИК, която е математически неиздържана и позволява да се манипулират изборните резултати на ниво персонификация на мандатите.

                            <P>Най-просто казано, ако за един мандат на малка партия се конкурират един "сговорчив" и един "несговорчив" депутат, ЦИК може да реши да влезе "сговорчивия", а "несговорчивият", дори да е лидер на партия, да остане извън парламента.

                                <P>Последното е особено важно за конфигурацията на бъдещия парламент, където най-вероятно ще има труден баланс на силите и сговорчивите депутати на малките партии ще имат особено висока цена.

                                    <P>Причината ЦИК да засекрети кода на софтуера очевидно се крие в нежеланието тези бъгове да станат обществено достояние. Става ясно също, че цената за изработването на софтуера от "Информационно обслужване" е потресаващо
                                        висока за вложения труд.

                                        <P>Прочетете <a href="https://bivol.bg/kalinci-code.html">още за методиката на ЦИК</a> и проблемите, които тя създава.
                                            <P>За да тествате бързо програмата с реални данни натиснете на бутона "Демо данни Избори 2013" или "Демо данни Избори 2009" и след това на "Калкулирай" под таблицата. Тъй като таблиците са доста широки се налага
                                                да се скролва надясно.
                                                <P>За да използвате програмата с данните за тези избори въведете ръчно в полетата на таблицата данните за всяка партия и всеки MИР. Можете също да заредите готови данни от файл във формат CSV*.</P>
                                                <P>Ако желаете и за целите на експеримента, броят на партиите и броят на МИР, както и броят мандати за всеки МИР, могат да бъдат свободно променяни с формуляра за генериране на данни по мярка.</P>
                                                <P>Автори: Проф. Любомир Гаврилов, Институт по математика, Тулуза (математически анализ), Д-р Стефан Манов (концепция и алгоритъм) , Делян Делчев (програмиране)</P>

        </div>
        <form id="dimensions">
            <fieldset>
                <legend>Начални данни</legend>
                <P>
                    <font color="red">Избори 2014: Официални данни на ЦИК 100% от страната 100% от чужбина:</font> <input value="Генерирай" onclick="fillDemo2014();" class="btn btn-warning" type="button"></P>
                <P>
                    <font color="red">Избори 2014: Официални данни на ЦИК. Симулация с 10 мандата в МИР "Чужбина":</font> <input value="Генерирай" onclick="fillDemo2014b();" class="btn btn-warning" type="button"></P>
                <P>Избори 2013: Официални данни на ЦИК 100% от страната 100% от чужбина: <input value="Генерирай" onclick="fillDemo2013();" class="btn btn-warning" type="button"></P>
                <P>Демо данни: Избори 2009 след касиране: 209 мандата/6 партии: <input value="Генерирай" onclick="fillDemo2009();" class="btn btn-warning" type="button"></P>
                <P>Демо данни, илюстриращи бъг в Методиката на ЦИК:<input value="Генерирай" onclick="fillDemoBug();" class="btn btn-warning" type="button"></P>
                <P>Или зареди файл с данни в CSV формат*: <input id="filename" type="file" onchange="loadFromFile();"></P>
                <P>Или генерирай данни по мярка:
                    <label>Брой МИР:</label><input id="dim_mir" value="32" type="number">
                    <label>Брой партии:</label><input id="dim_party" value="7" type="number"></P>

            </fieldset>
            <fieldset>
                <input id="dim_gen" value="Генерирай" onclick="genTable();" class="btn btn-primary" type="button">

            </fieldset>
        </form>
        <div id="visual">
        </div>
        <div>
            <P>* Програмата приема входни данни в CSV формат "МИР;Партия;Брой гласове". Примерно съдържание за 2 МИР-а и 2 партии:
                <BR> 1;Партия 1;18259
                <BR> 1;Партия 2;7823
                <BR> 2;Партия 1;8104
                <BR> 2;Партия 2;8409
                <BR>
                <P>
                    <P>Примерни файлове: <a href="elections-code_files/izbori2009.csv">Резултатите от парламентарните избори 2009 г. след касиране за разпределяне на 209 мандата по пропорционалната система (десен клик на линка и изберете "Download").</a></P>
        </div>
    </div>
    </div>
<!-- Биволъ АйТи, Дакси, Партньори, Социални мрежи, Банери --> 
<div class="container text-center">
<div class="row text-center">
<div class="text-center">
<p class="mt20 mb30"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div id="bivol-it-lang-tabs">
<ul class="nav nav-pills" role="tablist">
<li role="presentation" class="active"><a class="bivol-it-tab-button-bulgarian" href="#bivol-it-lang-bg" aria-controls="home" role="tab" data-toggle="tab">Български</a></li>
<li role="presentation"><a class="bivol-it-tab-button-english" href="#bivol-it-lang-en" aria-controls="profile" role="tab" data-toggle="tab">English</a></li>
</ul>
<div class="tab-content">
<div role="tabpanel" class="tab-pane fade in active" id="bivol-it-lang-bg">
<div class="text-center" id="search-tools">
<p class="it-support-us-title">"Биволъ" АйТи<br><small>Онлайн проекти и търсачки - "Биволъ" разработва бази данни и търсачки в помощ на разследващите журналисти, гражданските активисти и обществената прозрачност:</small></p>
</div>
<div class="text-center">
<p>
<a class="btn btn-default bivol-it-button" href="http://contracts.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за сключени договори за обществени поръчки за периода 2007-2015 г.">Обществени поръчки (ПОДПРБ)</a>
<a class="btn btn-default bivol-it-button" href="http://tr.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за фирмите в България за периода 01.2008-03.2016 г.">Търговски регистър (ПОДПРБ)</a>
<a class="btn btn-default bivol-it-button" href="http://dfz.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за европейски субсидии по ПРСР 2007-2013 г.">ДФЗ ПРСР</a>
<a class="btn btn-default bivol-it-button" href="http://isun.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за oперативни програми 2007-2013 г.">Оперативни програми ИСУН 2007-2013 г.</a>
<a class="btn btn-default bivol-it-button" href="http://dfz.bivol.bg/municipalities" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за европейски субсидии по мерки 321 и 322 (общинските мерки) на ПРСР 2007-2013 г.">ДФЗ ПРСР Общински мерки 321 и 322</a>
<a class="btn btn-default bivol-it-button" href="http://dfz.bivol.bg/guesthouses" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за къщи за гости субсидирани по ПРСР 2007-2013 г.">ДФЗ ПРСР Къщи за гости</a>
<a class="btn btn-default bivol-it-button" href="http://pep.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за декларации подадени пред Сметната Палата за периода 2007-2015 г.">Декларациите на властта (СП)</a>
<a class="btn btn-default bivol-it-button" href="http://agenti.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Търсачка за агенти на ДС разкрити от КОМДОС до края на 2015 г.">Десеводител (КОМДОС)</a>
<a class="btn btn-default bivol-it-button" href="http://ktb.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за влогове и кредити на властимащите в КТБ с бързи линкове към декларациите им пред Сметната Палата.">Властта и КТБ</a>
<a class="btn btn-default bivol-it-button" href="http://ktb.bivol.bg/secret" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за влогове и кредити в КТБ.">Сметки в КТБ</a>
<a class="btn btn-default bivol-it-button" href="http://forest.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за разрешителните за сеч за периода 2011-2015 г.">Разрешителни за сеч (ПОДПРБ)</a>
<a class="btn btn-default bivol-it-button" href="http://banks.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Търсачка в ипотечните кредити на КТБ и ПИБ до 2014 г.">Банки "Гнили Ябълки"</a>
<a class="btn btn-default bivol-it-button" href="http://pib.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за свързаното кредитиране в ПИБ.">ПИБ <span class="bivol-it-text-separator-dot"></span> FIBANK</a>
<a class="btn btn-default bivol-it-button" href="http://swaps.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка за заменките направени при Тройната коалиция.">Заменкигейт</a>
<a class="btn btn-default bivol-it-button" href="http://sunlight.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Searchable database of solicitation and award notices from FBO.gov.">Sunlight</a>
<a class="btn btn-default bivol-it-button" href="http://bspleaks.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Tърсачка в имейли на ръководството на БСП.">БСП Лийкс</a>
<a class="btn btn-default bivol-it-button" href="http://bsptrolls.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Търсачка в коментарите от тролове на БСП.">БСП Тролове</a>
<a class="btn btn-default bivol-it-button" href="http://bsptrolls.bivol.bg/yotovatrolls" target="_blank" data-toggle="tooltip" data-placement="top" title="Търсачка в коментарите от личните тролове на Илияна Йотова.">Троловете на Йотова</a>
<br>
<a class="btn btn-default bivol-it-button" href="http://search.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Едновременно търсене в реално време във всички бази данни на 'Биволъ'.">Глобално търсене във всички бази данни на "Биволъ"</a>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes "></p>
</div>
<div class="text-center">
<p class="it-support-us-title">За "Биволъ":<br><small>Независим, български сайт за разследваща журналистика. "Биволъ" е официален партньор на сайта "УикиЛийкс" (WikiLeaks) за България и Балканите и част от мрежата на OCCRP (Organized Crime and Corrpution Reporting Project - Международен проект за разследване на организираната престъпност и корупция). Екипът на "Биволъ" е създател и администратор на сайта "БолканЛийкс" (BalkanLeaks) - за сигурно и анонимно разкриване на поверителни или интригуващи документи и информация, свързани с политиката, престъпността или финансови машинации.</small></p>
<p>
<a class="btn btn-default bivol-it-button" href="https://wikileaks.org" target="_blank">УикиЛийкс</a>
<a class="btn btn-default bivol-it-button" href="https://www.occrp.org" target="_blank">OCCRP</a>
<a class="btn btn-default bivol-it-button" href="http://www.balkanleaks.eu" target="_blank">БолканЛийкс</a>
<a class="btn btn-default bivol-it-button" href="http://www.bivol.bg" target="_blank">Биволъ</a>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes "></p>
</div>
<div class="text-center">
<p class="it-support-us-title">Подробна и изчерпателна информация за фирмите в България може да бъде закупена от <a href="http://daxy.com" target="_blank">Daxy.com</a></p>
</div>
<div class="text-center mt20 mb20">
<p><a class="bivol-3rd-party-banner-link" href="http://daxy.com" target="_blank"><img class="img-responsive bivol-3rd-party-banner border-radius-4-yes box-shadow-yes opacity-08-on-hover grayscale-1-on-hover" src="http://search.bivol.bg/img/DAXY_baner_210x250_px.gif"></a></p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>

<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div class="text-center">
<p class="it-support-us-title">Следете публикациите на "Биволъ" във Фейсбук, Туитър и Ютюб:</p>
<p>
<a class="btn btn-default btn-lg bivol-it-button bivol-it-facebook-big" href="https://facebook.com/bivolnews" target="_blank">Биволъ във Facebook</a>
<a class="btn btn-default btn-lg bivol-it-button bivol-it-twitter-big" href="https://twitter.com/bivolbg" target="_blank">Биволъ в Twitter</a>
<a class="btn btn-default btn-lg bivol-it-button bivol-it-youtube-big" href="https://www.youtube.com/user/BivolBivol" target="_blank">Биволъ в YouTube</a>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div class="text-center">
<p class="it-support-us-title">Споделете "Биволъ" АйТи в социалните мрежи:</p>
<p>
<button class="btn btn-default bivol-it-button bivol-it-facebook bivol-it-share s_facebook" type="button">Facebook</button>
<button class="btn btn-default bivol-it-button bivol-it-twitter bivol-it-share s_twitter" type="button">Twitter</button>
<button class="btn btn-default bivol-it-button bivol-it-linkedin bivol-it-share s_linkedin" type='button'>LinkedIn</button>
<button class="btn btn-default bivol-it-button bivol-it-google-plus bivol-it-share s_plus" type="button">Google +</button>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div class="text-center" id="support-us">
<p class="it-support-us-title">Ако цените нашата работа подкрепете сайта "Биволъ" с дарение (банков превод, в брой - през Cashterminal, ePay.bg - EasyPay, PayPal, биткойни), абонамент или покупка на наш рекламен продукт:</p>
</div>
<div class="text-center">
<div class="bivol-banners-container">
<div class="bivol-banners-row">
<div class="bivol-banner bivol-banner-grayscale-1 bd1">
<a class="bivol-banner-link" href="https://shop.bivol.bg/bivol-tax" target="_blank">
<p class="bivol-banner-border bivol-banner-box"><img class="bivol-tax-banner" src="http://search.bivol.bg/img/donate_tax_square.png" alt="Bivol Tax"/></p>
<p class="bivol-banner-text"><strong><span>Данъкъ "Биволъ"</span></strong><br><span>Абонамент</span></p>
</a>
</div>
<div class="bivol-banner bivol-banner-grayscale-1 bd2">
<a class="bivol-banner-link" href="https://shop.bivol.bg" target="_blank">
<p class="bivol-banner-border"><img class="bivol-products-banner" src="http://search.bivol.bg/img/shop_hat_square.png" alt="Bivol Products"/></p>
<p class="bivol-banner-text"><span>Рекламни</span><br><span>продукти</span></p>
</a>
</div>
<div class="bivol-banner bivol-banner-grayscale-1 bd3">
<a class="bivol-banner-link" href="bitcoin:12JFL9S4BsMGFSr5jmDrcqRnWbfQQSgVaM">
<p class="bivol-banner-border"><img class="bivol-bitcoin-banner" src="http://search.bivol.bg/img/donate_bitcoin_square.png" alt="Bivol Bitcoin"/></p>
<p class="bivol-banner-text"><span>Биткойн</span><br><span>Bitcoin</span></p>
</a>
</div>
<div class="bivol-banner bivol-banner-grayscale-1 bd4">
<a class="bivol-banner-link" href="https://shop.bivol.bg" target="_blank">
<p class="bivol-banner-border"><img class="bivol-donations-banner" src="http://search.bivol.bg/img/donate_single_square.png" alt="Bivol Donations"/></p>
<p class="bivol-banner-text"><span>Дарения</span><br><span>Еднократни</span></p>
</a>
</div>
</div>
</div>
</div>
</div>  
<div role="tabpanel" class="tab-pane fade" id="bivol-it-lang-en">
<div class="text-center" id="search-tools-eng">
<p class="it-support-us-title">Bivol IT<br><small>Online projects and search engines - Bivol develops databases and search engines to help investigative journalists, civil activists and public transparency:</small></p>
</div>
<div class="text-center">
<p>
<a class="btn btn-default bivol-it-button" href="http://contracts.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="2007-2015 Bulgarian public procurement search engine - the information is provided by the Open Data Portal of the Bulgarian Government.">Public procurements</a>
<a class="btn btn-default bivol-it-button" href="http://tr.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="01.2008-03.2016 Bulgarian companies search engine - the information is provided by the Open Data Portal of the Bulgarian Government.">Commercial register</a>
<a class="btn btn-default bivol-it-button" href="http://dfz.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="2007-2013 Bulgarian State Fund Agriculture - Rural Development Programme - European Union subsidies search engine.">EU Rural Development Programme</a>
<a class="btn btn-default bivol-it-button" href="http://isun.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="2007-2013 Bulgarian operational programmes - European Union Funds Management Information System search engine.">2007-2013 Operational programmes EUMIS</a>
<a class="btn btn-default bivol-it-button" href="http://dfz.bivol.bg/municipalities" target="_blank" data-toggle="tooltip" data-placement="top" title="2007-2013 Bulgarian State Fund Agriculture - Rural Development Programme - Municipal measures 321 & 322 - European Union subsidies search engine.">Municipal projects with EU money</a>
<a class="btn btn-default bivol-it-button" href="http://dfz.bivol.bg/guesthouses" target="_blank" data-toggle="tooltip" data-placement="top" title="2007-2013 Bulgarian State Fund Agriculture - Rural Development Programme - Guest houses - European Union subsidies search engine.">Guest houses with EU money</a>
<a class="btn btn-default bivol-it-button" href="http://pep.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="2007-2015 Declarations to the Bulgarian National Audit Office by persons holding senior government and other positions in Bulgaria search engine - the information is provided by the Bulgarian National Audit Office.">PEP Declarations</a>
<a class="btn btn-default bivol-it-button" href="http://agenti.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="The Bulgarian Committee for State Security Agents (State Security Agents) exposed by COMDOS - the Bulgarian 'Files Committee' until the end of 2015 search engine - the information is provided by the Bulgarian 'Files Committee'.">Communist Agents</a>
<a class="btn btn-default bivol-it-button" href="http://ktb.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Deposits and credits in Bulgarian Corporate Commercial Bank of persons holding senior government and other positions in Bulgaria with links to their declarations to the Bulgarian National Audit Office search engine - the information is provided by the Bulgarian Deposit Insurance Fund.">CorpBank PEP Account Holders</a>
<a class="btn btn-default bivol-it-button" href="http://ktb.bivol.bg/secret" target="_blank" data-toggle="tooltip" data-placement="top" title="Deposits and credits in Bulgarian Corporate Commercial Bank search engine.">CorpBank Account Holders (password protected)</a>
<a class="btn btn-default bivol-it-button" href="http://forest.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="2011-2015 logging permits search engine - the information is provided by the Open Data Portal of the Bulgarian Government.">Logging permits</a>
<a class="btn btn-default bivol-it-button" href="http://banks.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Mortgage loans in Bulgarian Corporate Commercial Bank & Bulgarian First Investment Bank until 2014 search engine.">Bad Apples Banks</a>
<a class="btn btn-default bivol-it-button" href="http://pib.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Connected credits in Bulgarian First Investment Bank search engine.">FIBANK</a>
<a class="btn btn-default bivol-it-button" href="http://swaps.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Swaps made durring the 'Triple coalition' search engine.">Swapsgate</a>
<a class="btn btn-default bivol-it-button" href="http://sunlight.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Searchable database of solicitation and award notices from FBO.gov.">Sunlight</a>
<a class="btn btn-default bivol-it-button" href="http://bspleaks.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Еmails of the leadership of the Bulgarian communist party search engine.">BSP Leaks</a>
<a class="btn btn-default bivol-it-button" href="http://bsptrolls.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Comments by hybrid war trolls of the Bulgarian communist party search engine.">BSP Trolls</a>
<a class="btn btn-default bivol-it-button" href="http://bsptrolls.bivol.bg/yotovatrolls" target="_blank" data-toggle="tooltip" data-placement="top" title="Comments by the personal hybrid war trolls of the communist Iliana Iotova search engine.">Yotova Trolls</a>
<br>
<a class="btn btn-default bivol-it-button" href="http://search.bivol.bg" target="_blank" data-toggle="tooltip" data-placement="top" title="Simultaneous real-time search in all Bivol's databases.">Global search in all Bivol's databases</a>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes "></p>
</div>
<div class="text-center">
<p class="it-support-us-title">About Bivol:<br><small>Independent Bulgarian website about investigative journalism. Bivol is an official partner of WikiLeaks for Bulgaria and the Balkans and a part of the network of OCCRP (Organized Crime and Corrpution Reporting Project). The Bivol's team is the creator and administrator of the website BalkanLeaks - about secure and anonymous disclosure of sensitive information and confidential documents related to politics, crimes or financial machinations.</small></p>
<p>
<a class="btn btn-default bivol-it-button" href="https://wikileaks.org" target="_blank">WikiLeaks</a>
<a class="btn btn-default bivol-it-button" href="https://www.occrp.org" target="_blank">OCCRP</a>
<a class="btn btn-default bivol-it-button" href="http://www.balkanleaks.eu" target="_blank">BalkanLeaks</a>
<a class="btn btn-default bivol-it-button" href="http://www.bivol.bg" target="_blank">Bivol</a>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes "></p>
</div>
<div class="text-center">
<p class="it-support-us-title">Detailed and comprehensive information about the commercial companies in Bulgaria can be bought from <a href="http://daxy.com" target="_blank">Daxy.com</a></p>
</div>
<div class="text-center mt20 mb20">
<p><a class="bivol-3rd-party-banner-link" href="http://daxy.com" target="_blank"><img class="img-responsive bivol-3rd-party-banner border-radius-4-yes box-shadow-yes opacity-08-on-hover grayscale-1-on-hover" src="http://search.bivol.bg/img/DAXY_baner_210x250_px.gif"></a></p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>

<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div class="text-center">
<p class="it-support-us-title">Stay updated with Bivol's publications on Facebook, Twitter and YouTube:</p>
<p>
<a class="btn btn-default btn-lg bivol-it-button bivol-it-facebook-big" href="https://facebook.com/bivolnews" target="_blank">Bivol on Facebook</a>
<a class="btn btn-default btn-lg bivol-it-button bivol-it-twitter-big" href="https://twitter.com/bivolbg" target="_blank">Bivol on Twitter</a>
<a class="btn btn-default btn-lg bivol-it-button bivol-it-youtube-big" href="https://www.youtube.com/user/BivolBivol" target="_blank">Bivol on YouTube</a>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div class="text-center">
<p class="it-support-us-title">Share Bivol IT on social networks:</p>
<p>
<button class="btn btn-default bivol-it-button bivol-it-facebook bivol-it-share s_facebook" type="button">Facebook</button>
<button class="btn btn-default bivol-it-button bivol-it-twitter bivol-it-share s_twitter" type="button">Twitter</button>
<button class="btn btn-default bivol-it-button bivol-it-linkedin bivol-it-share s_linkedin" type='button'>LinkedIn</button>
<button class="btn btn-default bivol-it-button bivol-it-google-plus bivol-it-share s_plus" type="button">Google +</button>
</p>
</div>
<div class="text-center">
<p class="mt30 mb20"><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-separator grayscale-1 opacity-yes"></p>
</div>
<div class="text-center" id="support-us-eng">
<p class="it-support-us-title">If you appreciate our work - you may support Bivol by a donation (a bank transfer, cash - by Cashterminal, ePay.bg - EasyPay, PayPal, bitcoins), a subscription or to buy some of our branded products:</p>
</div>
<div class="text-center">
<div class="bivol-banners-container">
<div class="bivol-banners-row">
<div class="bivol-banner bivol-banner-grayscale-1 bd1">
<a class="bivol-banner-link" href="https://shop.bivol.bg/bivol-tax" target="_blank">
<p class="bivol-banner-border bivol-banner-box"><img class="bivol-tax-banner" src="http://search.bivol.bg/img/donate_tax_square.png" alt="Bivol Tax"/></p>
<p class="bivol-banner-text"><strong><span>Bivol Tax</span></strong><br><span>Subscription</span></p>
</a>
</div>
<div class="bivol-banner bivol-banner-grayscale-1 bd2">
<a class="bivol-banner-link" href="https://shop.bivol.bg" target="_blank">
<p class="bivol-banner-border"><img class="bivol-products-banner" src="http://search.bivol.bg/img/shop_hat_square.png" alt="Bivol Products"/></p>
<p class="bivol-banner-text"><span>Branded</span><br><span>products</span></p>
</a>
</div>
<div class="bivol-banner bivol-banner-grayscale-1 bd3">
<a class="bivol-banner-link" href="bitcoin:12JFL9S4BsMGFSr5jmDrcqRnWbfQQSgVaM">
<p class="bivol-banner-border"><img class="bivol-bitcoin-banner" src="http://search.bivol.bg/img/donate_bitcoin_square.png" alt="Bivol Bitcoin"/></p>
<p class="bivol-banner-text"><span>Bitcoin</span><br><span>Donations</span></p>
</a>
</div>
<div class="bivol-banner bivol-banner-grayscale-1 bd4">
<a class="bivol-banner-link" href="https://shop.bivol.bg" target="_blank">
<p class="bivol-banner-border"><img class="bivol-donations-banner" src="http://search.bivol.bg/img/donate_single_square.png" alt="Bivol Donations"/></p>
<p class="bivol-banner-text"><span>Donations</span><br><span>One-time</span></p>
</a>
</div>
</div>
</div>
</div>
</div>  
</div>  
</div>
<div class="text-center mt20">
<p><img src="http://search.bivol.bg/img/bivol_logo_small.png" class="bivol-logo-small grayscale-1"></p>
<p class="bivol-footer-text">Bivol IT | &copy; Bivol.bg</p>
</div>  
</div>
</div>
<!-- Биволъ АйТи, Дакси, Партньори, Социални мрежи, Банери -->  
 
 
<button class="scrollup"></button>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80602004-1', 'auto');
  ga('send', 'pageview');

</script>
 
<script type="text/javascript">
$(document).ready(function () {
		
		// Промяна на opacity на логото и заглавието при скрол.
		var headerLogo = $('.bivol-logo');
		var range = 140;

		//var headerTitle = $('.bivol-it-heading-with-opacity-change');
		//var range = 200;	

		$(window).scroll(function () {
			if ($(this).scrollTop() > 200) {
				$('.navbar, .scrollup').fadeIn();				
			} else {
				$('.navbar, .scrollup').fadeOut();				
			}
			
			// Промяна на opacity на логото и заглавието при скрол - на екрани по-малки от 768px.
			if($(window).width() <= 767){
				var scrollTop = $(this).scrollTop();
				var offsetLogo = headerLogo.offset().top;
				//var offsetTitle = headerTitle.offset().top;
				
				var heightLogo = headerLogo.outerHeight();
				//var heightTitle = headerTitle.outerHeight();
				
				offsetLogo = offsetLogo + heightLogo / 2;
				var calc = 1 - (scrollTop - offsetLogo + range) / range;
				
				//offsetTitle = offsetTitle + heightTitle / 2;
				//var calc = 1 - (scrollTop - offsetTitle + range) / range;
	  
				headerLogo.css({ 'opacity': calc });
				//headerTitle.css({ 'opacity': calc });
	  
				if ( calc > '1' ) {
					headerLogo.css({ 'opacity': 1 });
					//headerTitle.css({ 'opacity': 1 });
				} else if ( calc < '0' ) {
					headerLogo.css({ 'opacity': 0 });
					//headerTitle.css({ 'opacity': 0 });
				}
			}
			
		});

		$('.scrollup').click(function () {
			$('.bivol-logo-separator-nav').hide();
			$('.navbar-collapse').collapse('hide');
			$('html, body').animate({
				scrollTop: 0
			}, 600);
			return false;
		});
		
		// Показване и скриване на малкото лого - меню-сепаратор на малки екрани при отваряне/затваряне на менюто.
		$('button.navbar-toggle').click(function () {		
			if ($('.bivol-logo-separator-nav').is(':hidden'))  {			
				$('.bivol-logo-separator-nav').fadeIn();			
			}
			else {					
				$('.bivol-logo-separator-nav').hide();	
			}			
		});
		
		// Смяна на href-вете на навигацията ('Търсачки' и 'Подкрепете ни') при отваряне на езикови табове.
		$(function(){

			$(".bivol-it-tab-button-bulgarian").click(function(){
				$("a.bivol-it-nav-link-search-tools").attr('href', '#search-tools');
				$("a.bivol-it-nav-link-support-us").attr('href', '#support-us');
			});

			$(".bivol-it-tab-button-english").click(function(){
				$("a.bivol-it-nav-link-search-tools").attr('href', '#search-tools-eng');
				$("a.bivol-it-nav-link-support-us").attr('href', '#support-us-eng');			
			});
			
			$(".bivol-it-tab-button-french").click(function(){
				$("a.bivol-it-nav-link-search-tools").attr('href', '#search-tools-fr');
				$("a.bivol-it-nav-link-support-us").attr('href', '#support-us-fr');
			});
			
			$(".bivol-it-tab-button-german").click(function(){
				$("a.bivol-it-nav-link-search-tools").attr('href', '#search-tools-de');
				$("a.bivol-it-nav-link-support-us").attr('href', '#support-us-de');
			});	
			
		});
		
		// Tooltips.
		$(function () {
		    $('[data-toggle="tooltip"]').tooltip()
		})
		
		// Споделяне в социалните мрежи.
		$('.bivol-it-share').ShareLink({
            title: 'Търсачките на Биволъ | Bivol Search Engines',
            text: 'Бивол АйТи - онлайн бази данни и търсачки. | Bivol IT - online databases and search engines.',
            image: 'http://search.bivol.bg/img/bivol-logo-300x300.png',
            url: 'http://search.bivol.bg'
        });

});
</script>
</body>
</html>